import{bA as b,bE as x,bx as p,bS as B,bT as k,bF as e,bR as m}from"./vendor.c585d91c.js";import{u as w,B as I,I as N,b as j,F as c,a as D,M,v as T,c as q,h as f}from"./index.871f8bf3.js";import"./vant.d5548487.js";const E=u=>{const t=b(u);return{ref:t,toggle:()=>t.value=!t.value,on:()=>t.value=!0,off:()=>t.value=!1}},L="_logo_52hnt_1",O="_icon_52hnt_8",R="_appName_52hnt_12",r={logo:L,icon:O,appName:R},G=x({setup:(u,t)=>{const g=w(),o=p({email:"",code:""}),s=p({email:[],code:[]}),i=b(),{ref:y,toggle:A,on:h,off:v}=E(!1),_=B(),S=k(),C=async a=>{var l;if(a.preventDefault(),Object.assign(s,{email:[],code:[]}),Object.assign(s,T(o,[{key:"email",type:"required",message:"\u5FC5\u586B"},{key:"email",type:"pattern",regex:/.+@.+/,message:"\u5FC5\u987B\u662F\u90AE\u7BB1\u5730\u5740"},{key:"code",type:"required",message:"\u5FC5\u586B"}])),!q(s)){const n=await f.post("/session",o,{_autoLoading:!0}).catch(d);localStorage.setItem("jwt",n.data.jwt);const V=(l=S.query.return_to)==null?void 0:l.toString();g.refreshMe(),_.push(V||"/")}},d=a=>{throw a.response.status===422&&Object.assign(s,a.response.data.errors),a},F=async()=>{h(),await f.post("/validation_codes",{email:o.email},{_autoLoading:!0}).catch(d).finally(v),i.value.startCount()};return()=>e(M,null,{title:()=>"\u767B\u5F55",icon:()=>e(I,null,null),default:()=>e("div",{class:r.wrapper},[e("div",{class:r.logo},[e(N,{class:r.icon,name:"lamb"},null),e("h1",{class:r.appName},[m("\u5C0F\u7F8A\u8BB0\u8D26")])]),e(j,{onSubmit:C},{default:()=>{var a,l;return[e(c,{label:"\u90AE\u7BB1\u5730\u5740",type:"text",placeholder:"\u8BF7\u8F93\u5165\u90AE\u7BB1\u5730\u5740",modelValue:o.email,"onUpdate:modelValue":n=>o.email=n,error:(a=s.email)==null?void 0:a[0]},null),e(c,{ref:i,label:"\u9A8C\u8BC1\u7801",type:"validationCode",placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",countFrom:60,disabled:y.value,onClick:F,modelValue:o.code,"onUpdate:modelValue":n=>o.code=n,error:(l=s.code)==null?void 0:l[0]},null),e(c,{style:{paddingTop:"96px"}},{default:()=>[e(D,{type:"submit"},{default:()=>[m("\u767B\u5F55")]})]})]}})])})}});export{G as SignInPage,G as default};
